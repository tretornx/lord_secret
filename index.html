<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Escape Game - Pirate 80's</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .console-item {
      display: inline-block;
      margin: 10px;
      cursor: grab;
      text-align: center;
    }
    .console-item img {
      width: 100px;
      height: auto;
      border-radius: 8px;
    }
  </style>
</head>
<body>
<!-- Arrière-plan -->
<div class="background-image"></div>

<!-- Conteneur principal -->
<div id="login-container">
  <h1>Bienvenue dans le monde des pirates !</h1>
  <form id="login-form">
    <div class="input-group">
      <label for="email">Identifiant (email)</label>
      <input type="email" id="email" placeholder="Entrez votre email" required>
    </div>
    <div class="input-group">
      <label for="password">Mot de passe</label>
      <input type="password" id="password" placeholder="Entrez votre mot de passe" required>
    </div>
    <button type="button" id="login-button">Connexion</button>
    <p><a href="#" id="hint-link">Mot de passe oublié ?</a></p>
  </form>
</div>

<!-- Conteneur pour le puzzle des consoles -->
<div id="console-puzzle-container" style="display: none;">
  <h2>Placez les consoles portables Nintendo dans l'ordre chronologique</h2>
  <div id="console-puzzle"></div>
  <button id="validate-order">Valider l'ordre</button>
</div>

<!-- Scripts -->
<script>
  document.getElementById('hint-link').addEventListener('click', function(event) {
    event.preventDefault();
    document.getElementById('login-container').style.display = 'none';
    document.getElementById('console-puzzle-container').style.display = 'block';
    createPuzzle();
  });

  document.getElementById('login-button').addEventListener('click', function() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    // Ici, on suppose que la validation est réussie (à ajuster selon vos besoins)
    if (email && password) {
      window.location.href = 'dashboard.html';
    } else {
      alert('Veuillez entrer un identifiant et un mot de passe valides.');
    }
  });

  function createPuzzle() {
    const consoles = [
      { name: 'Game Boy', year: 1989, img: 'img/gameboy.jpg' },
      { name: 'Game Boy Color', year: 1998, img: 'img/gameboycolor.jpg' },
      { name: 'Game Boy Advance', year: 2001, img: 'img/gameboyadvance.jpg' },
      { name: 'Nintendo DS', year: 2004, img: 'img/nintendods.jpg' },
      { name: 'Nintendo 3DS', year: 2011, img: 'img/nintendo3ds.jpg' },
      { name: 'Nintendo Switch Lite', year: 2019, img: 'img/switchlite.jpg' }
    ];

    let shuffledConsoles = [...consoles].sort(() => Math.random() - 0.5);
    const puzzleContainer = document.getElementById('console-puzzle');
    puzzleContainer.innerHTML = '';

    shuffledConsoles.forEach(console => {
      const consoleDiv = document.createElement('div');
      consoleDiv.classList.add('console-item');
      consoleDiv.dataset.year = console.year;
      consoleDiv.draggable = true;
      consoleDiv.innerHTML = `<img src="${console.img}" alt="${console.name}"><p>${console.name}</p>`;
      puzzleContainer.appendChild(consoleDiv);
    });
    addDragAndDropEvents();
  }

  function addDragAndDropEvents() {
    const items = document.querySelectorAll('.console-item');
    items.forEach(item => {
      item.addEventListener('dragstart', handleDragStart);
      item.addEventListener('dragover', handleDragOver);
      item.addEventListener('drop', handleDrop);
    });
  }

  let draggedItem = null;

  function handleDragStart(event) {
    draggedItem = this;
    event.dataTransfer.effectAllowed = 'move';
    event.dataTransfer.setData('text/html', this.outerHTML);
    this.classList.add('dragging');
  }

  function handleDragOver(event) {
    event.preventDefault();
    event.dataTransfer.dropEffect = 'move';
  }

  function handleDrop(event) {
    event.preventDefault();
    if (draggedItem !== this) {
      const puzzleContainer = document.getElementById('console-puzzle');
      const items = Array.from(puzzleContainer.children);
      const draggedIndex = items.indexOf(draggedItem);
      const targetIndex = items.indexOf(this);

      if (draggedIndex > targetIndex) {
        puzzleContainer.insertBefore(draggedItem, this);
      } else {
        puzzleContainer.insertBefore(draggedItem, this.nextSibling);
      }
    }
    draggedItem.classList.remove('dragging');
    draggedItem = null;
  }

  document.getElementById('validate-order').addEventListener('click', function() {
    const items = document.querySelectorAll('.console-item');
    let correct = true;
    const consolesOrder = [1989, 1998, 2001, 2004, 2011, 2019];

    items.forEach((item, index) => {
      if (parseInt(item.dataset.year) !== consolesOrder[index]) {
        correct = false;
      }
    });

    if (correct) {
      alert('Bravo ! L\'indice c\'est le nom de ton fidèle compagnon');
      document.getElementById('console-puzzle-container').style.display = 'none';
      document.getElementById('login-container').style.display = 'block';
    } else {
      alert('Dommage, réessayez !');
    }
  });
</script>
</body>
</html>
